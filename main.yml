---
- name: common plays
  hosts:
    - server
    - pi
  roles:
    - privilege
    - timesync
    - package
    - dotfiles
    - docker

- name: main server
  hosts:
    - pve02-ubuntu1.lan

  tasks:
    - name: start gitlab-ce service with docker-compose
      become: yes
      community.docker.docker_compose:
        project_src: "/home/{{ ansible_user }}/services/gitlab-ce"
        state: present
        pull: yes

    - name: start docker-registry service with docker-compose
      become: yes
      community.docker.docker_compose:
        project_src: "/home/{{ ansible_user }}/services/docker-registry"
        state: present
        pull: yes
